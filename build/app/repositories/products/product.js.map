{"version":3,"sources":["../../../../src/app/repositories/products/product.js"],"names":["getAllBooks","req","query","cur_page","per_page","rest","Promise","resolve","reject","apiModels","books","findAndCountAll","offset","limit","include","model","authors","required","where","then","obj","e","getAllProducts","product","findAll","getAllBooksAtStores","_isbn","_store_id","isbn","storeQuery","store_id","products_at_stores"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;AAEO,SAASA,WAAT,CAAqBC,GAArB,EAA0B;AAC/B,MAAIC,KAAK,GAAGD,GAAG,CAACC,KAAhB;AACA,MAAMC,QAAN,GAAsCD,KAAtC,CAAMC,QAAN;AAAA,MAAgBC,QAAhB,GAAsCF,KAAtC,CAAgBE,QAAhB;AAAA,MAA6BC,IAA7B,6CAAsCH,KAAtC;AACA,SAAO,IAAII,OAAJ;AAAA,6FAAY,kBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACXC,SAAS,CAACC,KAAV,CACHC,eADG,CACa;AACfC,gBAAAA,MAAM,EAAEX,GAAG,CAACW,MADG;AAEfC,gBAAAA,KAAK,EAAEZ,GAAG,CAACY,KAFI;AAGfC,gBAAAA,OAAO,EAAE,CACP;AACEC,kBAAAA,KAAK,EAAEN,SAAS,CAACO,OADnB;AAEEC,kBAAAA,QAAQ,EAAE;AAFZ,iBADO,CAHM;AASfC,gBAAAA,KAAK,oBAAOb,IAAP;AATU,eADb,EAYHc,IAZG;AAAA,0GAYE,iBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AACJb,0BAAAA,OAAO,CAACa,GAAD,CAAP;;AADI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAZF;;AAAA;AAAA;AAAA;AAAA,4BAeG,UAACC,CAAD,EAAO;AACZb,gBAAAA,MAAM,CAACa,CAAD,CAAN;AACD,eAjBG,CADW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAZ;;AAAA;AAAA;AAAA;AAAA,MAAP;AAoBD;;AAEM,SAASC,cAAT,GAA0B;AAC/B,SAAO,IAAIhB,OAAJ;AAAA,8FAAY,kBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACXC,SAAS,CAACc,OAAV,CACHC,OADG,GAEHL,IAFG,CAEE,UAACC,GAAD,EAAS;AACbb,gBAAAA,OAAO,CAACa,GAAD,CAAP;AACD,eAJG,WAKG,UAACC,CAAD,EAAO;AACZb,gBAAAA,MAAM,CAACa,CAAD,CAAN;AACD,eAPG,CADW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAZ;;AAAA;AAAA;AAAA;AAAA,MAAP;AAUD;;AAEM,SAASI,mBAAT,CAA6BC,KAA7B,EAAoCC,SAApC,EAA+C;AACpD,SAAO,IAAIrB,OAAJ;AAAA,8FAAY,kBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AACbN,cAAAA,KADa,GACL,EADK;AAEjB,kBAAIwB,KAAJ,EAAWxB,KAAK,CAAC0B,IAAN,GAAaF,KAAb;AAEPG,cAAAA,UAJa,GAIA,EAJA;AAKjB,kBAAIF,SAAJ,EAAeE,UAAU,CAACC,QAAX,GAAsBH,SAAtB;AALE;AAAA,qBAOXlB,SAAS,CAACsB,kBAAV,CACHP,OADG,CACK;AACPN,gBAAAA,KAAK,EAAEW,UADA;AAEPf,gBAAAA,OAAO,EAAE;AACPC,kBAAAA,KAAK,EAAEN,SAAS,CAACc,OADV;AAEPL,kBAAAA,KAAK,EAAEhB;AAFA;AAFF,eADL,EAQHiB,IARG,CAQE,UAACC,GAAD,EAAS;AACbb,gBAAAA,OAAO,CAACa,GAAD,CAAP;AACD,eAVG,WAWG,UAACC,CAAD,EAAO;AACZb,gBAAAA,MAAM,CAACa,CAAD,CAAN;AACD,eAbG,CAPW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAZ;;AAAA;AAAA;AAAA;AAAA,MAAP;AAsBD","sourcesContent":["import helper from \"../../helper/helper\";\r\n\r\nexport function getAllBooks(req) {\r\n  let query = req.query\r\n  let { cur_page, per_page, ...rest } = query;\r\n  return new Promise(async (resolve, reject) => {\r\n    await apiModels.books\r\n      .findAndCountAll({\r\n        offset: req.offset,\r\n        limit: req.limit,\r\n        include: [\r\n          {\r\n            model: apiModels.authors,\r\n            required: true,\r\n          },\r\n        ],\r\n        where: { ...rest },\r\n      })\r\n      .then(async (obj) => {\r\n        resolve(obj);\r\n      })\r\n      .catch((e) => {\r\n        reject(e);\r\n      });\r\n  });\r\n}\r\n\r\nexport function getAllProducts() {\r\n  return new Promise(async (resolve, reject) => {\r\n    await apiModels.product\r\n      .findAll()\r\n      .then((obj) => {\r\n        resolve(obj);\r\n      })\r\n      .catch((e) => {\r\n        reject(e);\r\n      });\r\n  });\r\n}\r\n\r\nexport function getAllBooksAtStores(_isbn, _store_id) {\r\n  return new Promise(async (resolve, reject) => {\r\n    let query = {};\r\n    if (_isbn) query.isbn = _isbn;\r\n\r\n    let storeQuery = {};\r\n    if (_store_id) storeQuery.store_id = _store_id;\r\n\r\n    await apiModels.products_at_stores\r\n      .findAll({\r\n        where: storeQuery,\r\n        include: {\r\n          model: apiModels.product,\r\n          where: query,\r\n        },\r\n      })\r\n      .then((obj) => {\r\n        resolve(obj);\r\n      })\r\n      .catch((e) => {\r\n        reject(e);\r\n      });\r\n  });\r\n}\r\n"],"file":"product.js"}